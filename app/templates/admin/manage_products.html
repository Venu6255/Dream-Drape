{% extends "base.html" %}

{% block title %}Manage Products - Dream & Drape Admin{% endblock %}

{% block content %}
<h2>Manage Products</h2>
<a href="{{ url_for('admin.add_product') }}" class="btn btn-primary mb-3">Add New Product</a>
<table class="table table-striped table-bordered admin-table selectable">
  <thead>
    <tr>
      <th>Name</th>
      <th>Category</th>
      <th>Price</th>
      <th>Stock</th>
      <th>Status</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for product in products.items %}
    <tr data-id="{{ product.id }}">
      <td>{{ product.name }}</td>
      <td>
        {% for category in product.categories %}
          {{ category.name }}{% if not loop.last %}, {% endif %}
        {% endfor %}
      </td>
      <td>₹{{ "%.2f"|format(product.price) }}</td>
      <td>{{ product.stock_quantity }}</td>
      <td>
        {% if product.is_active %}
          <span class="badge bg-success">Active</span>
        {% else %}
          <span class="badge bg-secondary">Inactive</span>
        {% endif %}
      </td>
      <td>
        <a href="{{ url_for('admin.edit_product', id=product.id) }}" class="btn btn-sm btn-outline-primary">Edit</a>
        <a href="{{ url_for('admin.delete_product', id=product.id) }}" class="btn btn-sm btn-outline-danger" onclick="return confirm('Delete product?')">Delete</a>
      </td>
    </tr>
    {% else %}
    <tr><td colspan="6" class="text-center">No products found.</td></tr>
    {% endfor %}
  </tbody>
</table>

<nav aria-label="Product pagination">
  <ul class="pagination justify-content-center">
    {% if products.has_prev %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('admin.manage_products', page=products.prev_num) }}">Previous</a>
      </li>
    {% endif %}
    {% for p in products.iter_pages() %}
      {% if p %}
        <li class="page-item {% if p == products.page %}active{% endif %}">
          <a class="page-link" href="{{ url_for('admin.manage_products', page=p) }}">{{ p }}</a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link">…</span></li>
      {% endif %}
    {% endfor %}
    {% if products.has_next %}
      <li class="page-item">
        <a class="page-link" href="{{ url_for('admin.manage_products', page=products.next_num) }}">Next</a>
      </li>
    {% endif %}
  </ul>
</nav>
{% endblock %}
